<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ Privy SDK</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .log {
            background: #000;
            color: #00ff00;
            padding: 20px;
            border-radius: 8px;
            font-family: monospace;
            max-height: 400px;
            overflow-y: auto;
            margin: 20px 0;
        }
        .status {
            padding: 10px;
            margin: 10px 0;
            border-radius: 4px;
            font-weight: bold;
        }
        .success { background-color: #d4edda; color: #155724; }
        .error { background-color: #f8d7da; color: #721c24; }
        .warning { background-color: #fff3cd; color: #856404; }
        .info { background-color: #d1ecf1; color: #0c5460; }
    </style>
</head>
<body>
    <h1>üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ Privy SDK</h1>
    
    <div id="status-container">
        <div class="status info">‚è≥ –ù–∞—á–∏–Ω–∞–µ–º –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É...</div>
    </div>
    
    <div class="log" id="log-container"></div>
    
    <button onclick="runDiagnostic()" style="padding: 10px 20px; font-size: 16px;">üîÑ –ü–æ–≤—Ç–æ—Ä–∏—Ç—å –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É</button>
    
    <script>
        let logContainer = document.getElementById('log-container');
        let statusContainer = document.getElementById('status-container');
        
        function log(message, isError = false) {
            const timestamp = new Date().toLocaleTimeString();
            const color = isError ? '#ff4444' : '#00ff00';
            logContainer.innerHTML += `<div style="color: ${color}">[${timestamp}] ${message}</div>`;
            logContainer.scrollTop = logContainer.scrollHeight;
            console.log(message);
        }
        
        function setStatus(message, type = 'info') {
            statusContainer.innerHTML = `<div class="status ${type}">${message}</div>`;
        }
        
        async function runDiagnostic() {
            logContainer.innerHTML = '';
            setStatus('‚è≥ –ü—Ä–æ–≤–æ–¥–∏–º –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É...', 'info');
            
            log('üöÄ –ù–∞—á–∏–Ω–∞–µ–º –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É Privy SDK');
            
            // Test 1: Check if we can load Privy SDK
            try {
                log('üì¶ –ü–æ–ø—ã—Ç–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ Privy SDK...');
                setStatus('üì¶ –ó–∞–≥—Ä—É–∂–∞–µ–º Privy SDK...', 'info');
                
                const loadPromise = new Promise((resolve, reject) => {
                    const timeout = setTimeout(() => {
                        reject(new Error('–¢–∞–π–º–∞—É—Ç –∑–∞–≥—Ä—É–∑–∫–∏ SDK (10 —Å–µ–∫—É–Ω–¥)'));
                    }, 10000);
                    
                    const script = document.createElement('script');
                    script.src = 'https://unpkg.com/@privy-io/js-sdk@latest';
                    script.onload = () => {
                        clearTimeout(timeout);
                        resolve();
                    };
                    script.onerror = () => {
                        clearTimeout(timeout);
                        reject(new Error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å–∫—Ä–∏–ø—Ç–∞'));
                    };
                    document.head.appendChild(script);
                });
                
                await loadPromise;
                log('‚úÖ Privy SDK —Å–∫—Ä–∏–ø—Ç –∑–∞–≥—Ä—É–∂–µ–Ω —É—Å–ø–µ—à–Ω–æ');
                
            } catch (error) {
                log(`‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ Privy SDK: ${error.message}`, true);
                setStatus(`‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏: ${error.message}`, 'error');
                return;
            }
            
            // Test 2: Check if Privy object exists
            await new Promise(resolve => setTimeout(resolve, 1000));
            
            if (typeof window.Privy === 'undefined') {
                log('‚ùå window.Privy –Ω–µ –Ω–∞–π–¥–µ–Ω –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏', true);
                setStatus('‚ùå Privy SDK –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏', 'error');
                return;
            }
            
            log('‚úÖ window.Privy –Ω–∞–π–¥–µ–Ω');
            
            // Test 3: Try to create Privy instance
            try {
                log('üîß –ü–æ–ø—ã—Ç–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è —ç–∫–∑–µ–º–ø–ª—è—Ä–∞ Privy...');
                setStatus('üîß –°–æ–∑–¥–∞–µ–º —ç–∫–∑–µ–º–ø–ª—è—Ä Privy...', 'info');
                
                const privy = window.Privy.create('cmbhhu8sr00mojr0l66siei2z', {
                    embeddedWallets: {
                        createOnLogin: 'users-without-wallets'
                    },
                    appearance: {
                        theme: 'light',
                        accentColor: '#6A6FF5'
                    }
                });
                
                if (!privy) {
                    throw new Error('Privy.create –≤–µ—Ä–Ω—É–ª null');
                }
                
                log('‚úÖ –≠–∫–∑–µ–º–ø–ª—è—Ä Privy —Å–æ–∑–¥–∞–Ω —É—Å–ø–µ—à–Ω–æ');
                
                // Test 4: Try to initialize
                log('‚è≥ –ü–æ–ø—ã—Ç–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ Privy...');
                setStatus('‚è≥ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º Privy...', 'info');
                
                const readyTimeout = new Promise((_, reject) => 
                    setTimeout(() => reject(new Error('–¢–∞–π–º–∞—É—Ç –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ (8 —Å–µ–∫—É–Ω–¥)')), 8000)
                );
                
                await Promise.race([privy.ready(), readyTimeout]);
                
                log('‚úÖ Privy –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!');
                setStatus('‚úÖ Privy SDK –ø–æ–ª–Ω–æ—Å—Ç—å—é –≥–æ—Ç–æ–≤!', 'success');
                
                // Test 5: Check user state
                try {
                    const user = await privy.user.get();
                    if (user && user.user) {
                        log(`üë§ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–∂–µ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω: ${user.user.id}`);
                    } else {
                        log('üë§ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω');
                    }
                } catch (userError) {
                    log(`‚ÑπÔ∏è –°–æ—Å—Ç–æ—è–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ: ${userError.message}`);
                }
                
            } catch (error) {
                log(`‚ùå –û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ Privy: ${error.message}`, true);
                setStatus(`‚ùå –û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏: ${error.message}`, 'error');
                return;
            }
            
            log('üéâ –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ!');
        }
        
        // Run diagnostic automatically
        runDiagnostic();
    </script>
</body>
</html> 